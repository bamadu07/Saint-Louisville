<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - Mairie de Saint-Louis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
   
</head>
<body>
    <!-- Header avec navbar compacte -->
    <header>
        <div class="header-container">
            <a href="index.html" class="logo">
                <div class="logo-image">
                    <img src="images/logomairi2.png" 
                         alt="Logo Mairie de Saint-Louis" 
                         class="logo-img">
                </div>
                <div class="logo-text">
                    <h1>Mairie de <span>Saint-Louis</span></h1>
                    <p>Sénégal - Patrimoine UNESCO</p>
                </div>
            </a>
            
            <!-- Navbar Desktop Compacte -->
            <nav class="desktop-nav">
                <ul>
                    <li><a href="index.html">Accueil</a></li>
                    <li><a href="ville.html">La Ville</a></li>
                    <li><a href="mairie.html">Histoire & Patrimoine</a></li>
                    <li><a href="demarches.html">Démarches</a></li>
                    <li><a href="blog.html"><i class="fas fa-newspaper"></i> Blog</a></li>
                    <li><a href="contact.html" class="active">Contact</a></li>
                </ul>
            </nav>
            
            <!-- Bouton menu mobile -->
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <!-- Menu mobile compact -->
        <div class="mobile-menu" id="mobileMenu">
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="ville.html">La Ville</a></li>
                <li><a href="mairie.html">Histoire & Patrimoine</a></li>
                <li><a href="demarches.html">Démarches</a></li>
                <li><a href="blog.html"><i class="fas fa-newspaper"></i> Blog</a></li>
                <li><a href="contact.html" class="active">Contact</a></li>
            </ul>
        </div>
    </header>

    <!-- Header Slider avec 2 images -->
    <section class="header-slider">
        <div class="slider-container">
            <div class="slider-track" id="headerSliderTrack">
                <!-- Slide 1 -->
                <div class="slider-slide">
                    <img src="images/pont2.jpg" 
                         alt="Contact Mairie de Saint-Louis">
                    <div class="slider-overlay">
                        <h2>Contactez la Mairie de Saint-Louis</h2>
                        <p>Nous sommes à votre écoute pour répondre à toutes vos questions et préoccupations</p>
                    </div>
                </div>
                
                <!-- Slide 2 -->
                <div class="slider-slide">
                    <img src="images/rose2.jpg" 
                         alt="Mairie de Saint-Louis">
                    <div class="slider-overlay">
                        <h2>Notre Équipe Municipale</h2>
                        <p>Une équipe dévouée prête à vous aider et à vous accompagner</p>
                    </div>
                </div>
            </div>
            
            <div class="slider-controls" id="headerSliderDots">
                <!-- Les points seront générés par JavaScript -->
            </div>
        </div>
    </section>

    <!-- Informations de Contact -->
    <section class="contact-info-section">
        <div class="container">
            <h2 class="section-title">Nos Coordonnées</h2>
            <div class="contact-grid">
                <div class="contact-card animate-on-scroll">
                    <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <h3>Adresse</h3>
                    <p>Mairie de Saint-Louis<br>
                    Place Faidherbe<br>
                    Île de Saint-Louis<br>
                    Sénégal</p>
                </div>
                
                <div class="contact-card animate-on-scroll">
                    <div class="contact-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <h3>Téléphone</h3>
                    <p>Standard : +221 33 961 10 10<br>
                    Fax : +221 33 961 10 11<br>
                    Urgences : +221 33 961 10 12</p>
                </div>
                
                <div class="contact-card animate-on-scroll">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h3>Email</h3>
                    <p>o.ndiaye@bcmgroupe.com<br>
                    etatcivil@mairie-saintlouis.sn<br>
                    urbanisme@mairie-saintlouis.sn</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Carte et Horaires -->
    <section class="map-section">
        <div class="container">
            <div class="map-container">
                <div class="animate-on-scroll">
                    <h3>Carte de Saint-Louis</h3>
                    <div class="map-iframe-container">
                        <iframe 
                            class="map-iframe"
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3859.111979428787!2d-16.50537172477041!3d16.026017071527372!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xec2128b2f0cc8cb%3A0xa96e87b2a2a5e8b1!2sSaint-Louis%2C%20Senegal!5e0!3m2!1sfr!2sfr!4v1700000000000!5m2!1sfr!2sfr" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade"
                            title="Carte de Saint-Louis, Sénégal">
                        </iframe>
                        <div class="map-overlay">
                            <h4><i class="fas fa-map-marker-alt"></i> Mairie de Saint-Louis</h4>
                            <a href="https://goo.gl/maps/ABC123DEF456" target="_blank" class="btn-small">
                                <i class="fas fa-directions"></i> Itinéraire
                            </a>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                        <a href="https://www.google.com/maps/place/Saint-Louis,+Senegal/@16.0259,-16.5031,15z" 
                           target="_blank" 
                           class="btn" 
                           style="background-color: var(--primary-color); color: white; padding: 10px 20px; font-size: 0.9rem;">
                            <i class="fas fa-external-link-alt"></i> Ouvrir dans Google Maps
                        </a>
                        <a href="https://www.openstreetmap.org/#map=15/16.0259/-16.5031" 
                           target="_blank" 
                           class="btn" 
                           style="background-color: #f8f9fa; color: var(--primary-color); padding: 10px 20px; font-size: 0.9rem;">
                            <i class="fas fa-map"></i> Voir sur OpenStreetMap
                        </a>
                    </div>
                </div>
                
                <div class="horaires animate-on-scroll">
                    <h3>Horaires d'ouverture</h3>
                    <p>La mairie est ouverte au public aux horaires suivants :</p>
                    
                    <table class="horaires-table">
                        <thead>
                            <tr>
                                <th>Jour</th>
                                <th>Matin</th>
                                <th>Après-midi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Lundi</td>
                                <td>8h00 - 12h30</td>
                                <td>14h00 - 17h30</td>
                            </tr>
                            <tr>
                                <td>Mardi</td>
                                <td>8h00 - 12h30</td>
                                <td>14h00 - 17h30</td>
                            </tr>
                            <tr>
                                <td>Mercredi</td>
                                <td>8h00 - 12h30</td>
                                <td>14h00 - 17h30</td>
                            </tr>
                            <tr>
                                <td>Jeudi</td>
                                <td>8h00 - 12h30</td>
                                <td>14h00 - 17h30</td>
                            </tr>
                            <tr>
                                <td>Vendredi</td>
                                <td>8h00 - 12h30</td>
                                <td>14h00 - 16h30</td>
                            </tr>
                            <tr>
                                <td>Samedi</td>
                                <td>9h00 - 13h00</td>
                                <td>Fermé</td>
                            </tr>
                            <tr>
                                <td>Dimanche</td>
                                <td colspan="2">Fermé</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <p style="margin-top: 20px; font-style: italic;">Fermetures exceptionnelles : les jours fériés et le 14 juillet (fête nationale).</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Formulaire de Contact -->
    <section class="contact-form-section">
        <div class="container">
            <h2 class="section-title">Envoyez-nous un message</h2>
            <div class="form-container animate-on-scroll">
                <!-- Messages système -->
                <div class="alert alert-success" id="successMessage" style="display: none;"></div>
                <div class="alert alert-error" id="errorMessage" style="display: none;"></div>
                <div class="alert alert-warning" id="warningMessage" style="display: none;"></div>
                <div class="alert alert-info" id="infoMessage" style="display: none;"></div>
                
                <form id="contactForm" method="POST">
                    <!-- Honeypot field pour la protection anti-spam -->
                    <div class="honeypot">
                        <label for="website">Ne pas remplir ce champ</label>
                        <input type="text" id="website" name="website">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nom">Nom *</label>
                            <input type="text" id="nom" name="nom" class="form-control" required>
                            <div class="error-message" id="nom-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="prenom">Prénom *</label>
                            <input type="text" id="prenom" name="prenom" class="form-control" required>
                            <div class="error-message" id="prenom-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" class="form-control" required>
                            <div class="error-message" id="email-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="telephone">Téléphone</label>
                            <input type="tel" id="telephone" name="telephone" class="form-control">
                            <div class="error-message" id="telephone-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="adresse">Adresse</label>
                        <input type="text" id="adresse" name="adresse" class="form-control" placeholder="Votre adresse à Saint-Louis">
                    </div>
                    
                    <div class="form-group">
                        <label for="service">Service concerné *</label>
                        <select id="service" name="service" class="form-control" required>
                            <option value="">Sélectionnez un service</option>
                            <option value="État Civil">État Civil</option>
                            <option value="Urbanisme">Urbanisme</option>
                            <option value="Propreté et Environnement">Propreté et Environnement</option>
                            <option value="Marchés et Commerces">Marchés et Commerces</option>
                            <option value="Culture et Patrimoine">Culture et Patrimoine</option>
                            <option value="Sports et Loisirs">Sports et Loisirs</option>
                            <option value="Affaires Sociales">Affaires Sociales</option>
                            <option value="Services Techniques">Services Techniques</option>
                            <option value="Finances">Finances</option>
                            <option value="Communication">Communication</option>
                            <option value="Autre">Autre</option>
                        </select>
                        <div class="error-message" id="service-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="sujet">Sujet *</label>
                        <input type="text" id="sujet" name="sujet" class="form-control" required placeholder="Objet de votre message">
                        <div class="error-message" id="sujet-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="message">Message *</label>
                        <textarea id="message" name="message" class="form-control" rows="6" required placeholder="Décrivez votre demande en détail..."></textarea>
                        <div class="error-message" id="message-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="newsletter" name="newsletter" value="1" checked> 
                            M'abonner à la newsletter municipale pour recevoir les actualités de la mairie
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                            <i class="fas fa-info-circle"></i> Les champs marqués d'un * sont obligatoires.
                        </p>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <span id="btnText">Envoyer le message</span>
                        <div class="loader" id="btnLoader" style="display: none;"></div>
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>Mairie de Saint-Louis</h3>
                    <p>Première ville française d'Afrique de l'Ouest, classée au patrimoine mondial de l'UNESCO.</p>
                </div>
                
                <div class="footer-links">
                    <h4>Liens utiles</h4>
                    <ul>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="ville.html">La Ville</a></li>
                        <li><a href="mairie.html">Histoire & Patrimoine</a></li>
                        <li><a href="demarches.html">Démarches en ligne</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h4>Contact rapide</h4>
                    <p><i class="fas fa-phone"></i> +221 33 961 10 10</p>
                    <p><i class="fas fa-envelope"></i> o.ndiaye@bcmgroupe.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> Place Faidherbe, Île de Saint-Louis</p>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2025 Mairie de Saint-Louis / BCMGROUP - Tous droits réservés</p>
            </div>
        </div>
    </footer>

    <!-- Bouton retour en haut -->
    <div class="back-to-top" id="backToTop">
        <i class="fas fa-chevron-up"></i>
    </div>

    <script>
        // Document ready
        document.addEventListener('DOMContentLoaded', function() {
            // Header Slider
            const headerSliderTrack = document.getElementById('headerSliderTrack');
            const headerSlides = document.querySelectorAll('.header-slider .slider-slide');
            const headerDotsContainer = document.getElementById('headerSliderDots');
            
            let headerCurrentSlide = 0;
            const headerTotalSlides = headerSlides.length;
            
            // Créer les points pour le header slider
            if (headerDotsContainer && headerTotalSlides > 0) {
                for (let i = 0; i < headerTotalSlides; i++) {
                    const dot = document.createElement('div');
                    dot.classList.add('slider-dot');
                    if (i === 0) dot.classList.add('active');
                    dot.dataset.index = i;
                    headerDotsContainer.appendChild(dot);
                }
                
                const headerDots = document.querySelectorAll('.slider-dot');
                
                function updateHeaderSlider() {
                    headerSliderTrack.style.transform = `translateX(-${headerCurrentSlide * 100}%)`;
                    
                    // Mettre à jour les points actifs
                    headerDots.forEach(dot => dot.classList.remove('active'));
                    headerDots[headerCurrentSlide].classList.add('active');
                }
                
                // Navigation avec points pour le header
                headerDots.forEach(dot => {
                    dot.addEventListener('click', () => {
                        headerCurrentSlide = parseInt(dot.dataset.index);
                        updateHeaderSlider();
                    });
                });
                
                // Défilement automatique pour le header slider
                let headerAutoplay = setInterval(() => {
                    headerCurrentSlide = (headerCurrentSlide + 1) % headerTotalSlides;
                    updateHeaderSlider();
                }, 4000);
                
                // Pause au survol
                headerSliderTrack.addEventListener('mouseenter', () => clearInterval(headerAutoplay));
                headerSliderTrack.addEventListener('mouseleave', () => {
                    headerAutoplay = setInterval(() => {
                        headerCurrentSlide = (headerCurrentSlide + 1) % headerTotalSlides;
                        updateHeaderSlider();
                    }, 4000);
                });
            }
            
            // Menu mobile
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');

            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('active');
                    this.innerHTML = mobileMenu.classList.contains('active') ? 
                        '<i class="fas fa-times"></i>' : 
                        '<i class="fas fa-bars"></i>';
                });

                // Fermer le menu au clic sur un lien
                document.querySelectorAll('.mobile-menu a').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.remove('active');
                        mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    });
                });
            }

            // Animation au scroll
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            // Observer les éléments à animer
            document.querySelectorAll('.animate-on-scroll').forEach(el => {
                observer.observe(el);
            });

            // Bouton retour en haut
            const backToTopBtn = document.getElementById('backToTop');
            
            if (backToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (window.pageYOffset > 300) {
                        backToTopBtn.classList.add('visible');
                    } else {
                        backToTopBtn.classList.remove('visible');
                    }
                });

                backToTopBtn.addEventListener('click', () => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // ===== GESTION DU FORMULAIRE AMÉLIORÉ =====
            const contactForm = document.getElementById('contactForm');
            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const btnLoader = document.getElementById('btnLoader');
            
            // Fonction pour masquer tous les messages
            function hideAllMessages() {
                document.getElementById('successMessage').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
                document.getElementById('warningMessage').style.display = 'none';
                document.getElementById('infoMessage').style.display = 'none';
            }
            
            // Fonction pour afficher un message
            function showMessage(type, message) {
                const messageElement = document.getElementById(type + 'Message');
                messageElement.innerHTML = message;
                messageElement.style.display = 'block';
                
                // Faire défiler vers le message
                messageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Masquer après 10 secondes (sauf pour info)
                if (type !== 'info') {
                    setTimeout(() => {
                        messageElement.style.display = 'none';
                    }, 10000);
                }
            }
            
            // Fonction pour valider un champ
            function validateField(fieldId, validator, errorId, errorMessage) {
                const field = document.getElementById(fieldId);
                const value = field.value.trim();
                const formGroup = field.closest('.form-group');
                
                if (!value) {
                    document.getElementById(errorId).textContent = 'Ce champ est obligatoire';
                    document.getElementById(errorId).style.display = 'block';
                    formGroup.classList.add('error');
                    formGroup.classList.remove('success');
                    return false;
                }
                
                if (!validator(value)) {
                    document.getElementById(errorId).textContent = errorMessage;
                    document.getElementById(errorId).style.display = 'block';
                    formGroup.classList.add('error');
                    formGroup.classList.remove('success');
                    return false;
                }
                
                document.getElementById(errorId).style.display = 'none';
                formGroup.classList.remove('error');
                formGroup.classList.add('success');
                return true;
            }
            
            // Validation de l'email
            function validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
            
            // Validation du téléphone (Sénégal)
            function validatePhone(phone) {
                if (!phone) return true; // Téléphone optionnel
                const phoneRegex = /^(\+221|00221)?[0-9]{9}$/;
                const cleanedPhone = phone.replace(/[\s\-\(\)]/g, '');
                return phoneRegex.test(cleanedPhone);
            }
            
            // Formatage du téléphone
            function formatPhoneNumber(value) {
                let numbers = value.replace(/\D/g, '');
                
                if (numbers.length === 0) return '';
                
                if (numbers.length <= 2) {
                    return numbers;
                } else if (numbers.length <= 5) {
                    return numbers.substring(0, 2) + ' ' + numbers.substring(2);
                } else if (numbers.length <= 7) {
                    return numbers.substring(0, 2) + ' ' + numbers.substring(2, 5) + ' ' + numbers.substring(5);
                } else {
                    return numbers.substring(0, 2) + ' ' + numbers.substring(2, 5) + ' ' + numbers.substring(5, 7) + ' ' + numbers.substring(7, 9);
                }
            }
            
            if (contactForm && submitBtn) {
                // Validation en temps réel
                const nomInput = document.getElementById('nom');
                const prenomInput = document.getElementById('prenom');
                const emailInput = document.getElementById('email');
                const telephoneInput = document.getElementById('telephone');
                const serviceSelect = document.getElementById('service');
                const sujetInput = document.getElementById('sujet');
                const messageInput = document.getElementById('message');
                
                // Validation du nom
                nomInput.addEventListener('blur', () => {
                    validateField('nom', 
                        (value) => value.length >= 2, 
                        'nom-error', 
                        'Le nom doit contenir au moins 2 caractères'
                    );
                });
                
                // Validation du prénom
                prenomInput.addEventListener('blur', () => {
                    validateField('prenom', 
                        (value) => value.length >= 2, 
                        'prenom-error', 
                        'Le prénom doit contenir au moins 2 caractères'
                    );
                });
                
                // Validation de l'email
                emailInput.addEventListener('blur', () => {
                    validateField('email', 
                        validateEmail, 
                        'email-error', 
                        'Veuillez entrer une adresse email valide'
                    );
                });
                
                // Validation et formatage du téléphone
                telephoneInput.addEventListener('input', function() {
                    this.value = formatPhoneNumber(this.value);
                });
                
                telephoneInput.addEventListener('blur', () => {
                    validateField('telephone', 
                        validatePhone, 
                        'telephone-error', 
                        'Veuillez entrer un numéro de téléphone valide (ex: 77 123 45 67)'
                    );
                });
                
                // Validation du service
                serviceSelect.addEventListener('change', () => {
                    const value = serviceSelect.value;
                    const formGroup = serviceSelect.closest('.form-group');
                    
                    if (!value) {
                        document.getElementById('service-error').textContent = 'Ce champ est obligatoire';
                        document.getElementById('service-error').style.display = 'block';
                        formGroup.classList.add('error');
                        formGroup.classList.remove('success');
                    } else {
                        document.getElementById('service-error').style.display = 'none';
                        formGroup.classList.remove('error');
                        formGroup.classList.add('success');
                    }
                });
                
                // Validation du sujet
                sujetInput.addEventListener('blur', () => {
                    validateField('sujet', 
                        (value) => value.length >= 5, 
                        'sujet-error', 
                        'Le sujet doit contenir au moins 5 caractères'
                    );
                });
                
                // Validation du message
                messageInput.addEventListener('blur', () => {
                    validateField('message', 
                        (value) => value.length >= 10, 
                        'message-error', 
                        'Le message doit contenir au moins 10 caractères'
                    );
                });
                
                // Gestion de la soumission du formulaire
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Masquer tous les messages précédents
                    hideAllMessages();
                    
                    // Vérification honeypot
                    const honeypot = document.getElementById('website').value;
                    if (honeypot) {
                        // C'est probablement un bot, simuler un succès
                        showMessage('success', 'Votre message a bien été envoyé ! Nous vous répondrons dans les plus brefs délais.');
                        contactForm.reset();
                        return;
                    }
                    
                    // Validation avant soumission
                    const isNomValid = validateField('nom', 
                        (value) => value.length >= 2, 
                        'nom-error', 
                        'Le nom doit contenir au moins 2 caractères'
                    );
                    
                    const isPrenomValid = validateField('prenom', 
                        (value) => value.length >= 2, 
                        'prenom-error', 
                        'Le prénom doit contenir au moins 2 caractères'
                    );
                    
                    const isEmailValid = validateField('email', 
                        validateEmail, 
                        'email-error', 
                        'Veuillez entrer une adresse email valide'
                    );
                    
                    const isPhoneValid = validateField('telephone', 
                        validatePhone, 
                        'telephone-error', 
                        'Veuillez entrer un numéro de téléphone valide'
                    );
                    
                    const isServiceValid = serviceSelect.value ? true : false;
                    if (!isServiceValid) {
                        document.getElementById('service-error').textContent = 'Ce champ est obligatoire';
                        document.getElementById('service-error').style.display = 'block';
                        serviceSelect.closest('.form-group').classList.add('error');
                    }
                    
                    const isSujetValid = validateField('sujet', 
                        (value) => value.length >= 5, 
                        'sujet-error', 
                        'Le sujet doit contenir au moins 5 caractères'
                    );
                    
                    const isMessageValid = validateField('message', 
                        (value) => value.length >= 10, 
                        'message-error', 
                        'Le message doit contenir au moins 10 caractères'
                    );
                    
                    // Si tout est valide
                    if (isNomValid && isPrenomValid && isEmailValid && isPhoneValid && isServiceValid && isSujetValid && isMessageValid) {
                        // Désactiver le bouton pendant l'envoi
                        const originalText = btnText.textContent;
                        submitBtn.disabled = true;
                        btnText.textContent = 'Envoi en cours...';
                        btnLoader.style.display = 'inline-block';
                        
                        // Créer un FormData avec les données du formulaire
                        const formData = new FormData(contactForm);
                        
                        // Envoyer les données via AJAX vers send_email.php
                        fetch('send_email.php', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Erreur réseau: ' + response.status);
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                // Afficher le message de succès
                                showMessage('success', data.message || 'Votre message a bien été envoyé !');
                                
                                // Réinitialiser le formulaire
                                contactForm.reset();
                                
                                // Réinitialiser les états de validation
                                document.querySelectorAll('.form-group').forEach(group => {
                                    group.classList.remove('success', 'error');
                                });
                                
                                // Afficher un message d'information supplémentaire
                                setTimeout(() => {
                                    showMessage('info', 
                                        'Vous pouvez également nous contacter directement par téléphone au +221 33 961 10 10 pour une réponse plus rapide.'
                                    );
                                }, 2000);
                            } else {
                                // Afficher le message d'erreur
                                showMessage('error', data.message || "Une erreur s'est produite. Veuillez réessayer.");
                            }
                        })
                        .catch(error => {
                            console.error('Erreur:', error);
                            
                            // Solution de secours : utiliser mailto
                            showMessage('warning', 
                                "Envoi en cours... Si rien ne se passe, cliquez sur le lien ci-dessous :<br>" +
                                '<a href="mailto:o.ndiaye@bcmgroupe.com?subject=Message Mairie Saint-Louis&body=' + 
                                encodeURIComponent('Nom: ' + nomInput.value + '\n' +
                                                'Prénom: ' + prenomInput.value + '\n' +
                                                'Email: ' + emailInput.value + '\n' +
                                                'Téléphone: ' + (telephoneInput.value || 'Non spécifié') + '\n' +
                                                'Service: ' + serviceSelect.value + '\n' +
                                                'Sujet: ' + sujetInput.value + '\n' +
                                                'Message: ' + messageInput.value) + 
                                '" style="color: #856404; text-decoration: underline; margin-top: 10px; display: inline-block;">Ouvrir votre client email</a>'
                            );
                            
                            // Réinitialiser le formulaire
                            contactForm.reset();
                        })
                        .finally(() => {
                            // Rétablir le bouton
                            submitBtn.disabled = false;
                            btnText.textContent = originalText;
                            btnLoader.style.display = 'none';
                        });
                    } else {
                        // Faire défiler vers la première erreur
                        const firstError = document.querySelector('.error-message[style="display: block;"]');
                        if (firstError) {
                            firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }
                });
            }

            // Smooth scroll pour les ancres
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 100,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>